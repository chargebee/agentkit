# Generated by https://smithery.ai. See: https://smithery.ai/docs/config#dockerfile
#### Multi-stage Dockerfile for Chargebee MCP Server

# Stage 1: Build the project
FROM node:lts-alpine AS builder

WORKDIR /app

# Copy necessary files for building
COPY package.json tsconfig.json tsup.config.ts ./
COPY src ./src

# Install all dependencies (including devDependencies) and build
RUN npm install && npm run build

# Stage 2: Prepare the production image
FROM node:lts-alpine

WORKDIR /app

# Copy package.json for installing production dependencies
COPY package.json tsconfig.json ./

# Install only production dependencies
RUN npm install --production --ignore-scripts

# Copy built artifacts from the builder stage
COPY --from=builder /app/dist ./dist

# Expose any port if needed (not mandatory for MCP server running via stdio)

# Start the MCP server
CMD ["node", "dist/index.js"]
